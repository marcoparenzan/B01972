{"version":3,"file":"Score.js","sourceRoot":"","sources":["../../scripts/Score.ts"],"names":["MobileApp","MobileApp.Score","MobileApp.Score.initialize","MobileApp.Score.vote_session","MobileApp.Score.reload_session_info","MobileApp.Score.get_picture"],"mappings":"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","sourcesContent":["module MobileApp {\r\n    \"use strict\";\r\n\r\n    export module Score {\r\n        export function initialize() {\r\n            reload_session_info(\"http://sqlsat495.azurewebsites.net\");\r\n\r\n            // initialize take photo and share\r\n            $(document).find(\"#takePhotoAndShare\").click((): void => {\r\n\r\n                get_picture((photo: string) => {\r\n\r\n                    var url = \"http://sqlsat495.azurewebsites.net\";\r\n                    var twitter_handle = \"marco_parenzan\";\r\n                    var hashtag = \"sqlsat495\";\r\n\r\n                    alert(photo);\r\n\r\n                    var options: Microsoft.WindowsAzure.InvokeApiOptions = {\r\n                        body: {\r\n                            hashtags: [hashtag]\r\n                            , twitter_handles: [twitter_handle]\r\n                            , photoData: photo\r\n                            , photoName: twitter_handle + Date.now() + \".jpg\"\r\n                        },\r\n                        method: \"POST\"\r\n                    };\r\n\r\n                    var mobileAppsClient = new WindowsAzure.MobileServiceClient(url);\r\n                    var sessionsVotesTable = mobileAppsClient.invokeApi(\"Photos\", options).done(\r\n                        (result: any): void => {\r\n                            alert(\"Picture posted\");\r\n                        }\r\n                        , (error: any): void => {\r\n                            alert(\"ERROR:\" + error);\r\n                        }\r\n                    );\r\n\r\n                });\r\n\r\n            });\r\n\r\n            $(document).find(\"#vote_more\").click(function () {\r\n                var id: string = /\\d+/.exec(/id=\\d+/.exec(document.URL)[0])[0];\r\n                vote_session(\"http://sqlsat495.azurewebsites.net\", id, \"more\");\r\n            });\r\n        }\r\n\r\n        function vote_session(url: string, session_id: string, vote: string): void {\r\n            var mobileAppsClient = new WindowsAzure.MobileServiceClient(url);\r\n            var sessionsVotesTable = mobileAppsClient.getTable(\"SessionsVotes\");\r\n            sessionsVotesTable.insert({\r\n                session_id: session_id\r\n                ,\r\n                vote: vote\r\n            });\r\n        }\r\n\r\n        function reload_session_info(url: string): void {\r\n\r\n            var id: string = /\\d+/.exec(/id=\\d+/.exec(document.URL)[0])[0];\r\n\r\n            var mobileAppsClient = new WindowsAzure.MobileServiceClient(url);\r\n            var sessionsTable = mobileAppsClient.getTable(\"Sessions\");\r\n            sessionsTable.where({\r\n                \"id\": id\r\n            }).read().then((result: any) => {\r\n                var element: any = result[0];\r\n\r\n                $(\"#session_name\").html(element.session_name);\r\n                $(\"#session_url\").attr(\"href\", element.session_url);\r\n                $(\"#speaker_name\").html(element.speaker_name);\r\n                $(\"#speaker_url\").attr(\"href\", element.speaker_url);\r\n\r\n            }, (error: any) => {\r\n                alert(error);\r\n            });\r\n        }\r\n\r\n        function get_picture(handler: (data: string) => any): void {\r\n            navigator.camera.getPicture(\r\n                handler\r\n                , function (error: string): void {\r\n                    navigator.notification.alert(error, (): void => {\r\n                    });\r\n                },\r\n                {\r\n                    quality: 100,\r\n                    destinationType: Camera.DestinationType.DATA_URL,\r\n                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY,\r\n                    mediaType: Camera.MediaType.PICTURE,\r\n                    encodingType: Camera.EncodingType.PNG,\r\n                    saveToPhotoAlbum: true\r\n                }\r\n            );\r\n        }\r\n    }\r\n\r\n    window.onload = function () {\r\n        Application.initialize();\r\n        Score.initialize();\r\n    };\r\n}"]}